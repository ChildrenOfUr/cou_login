<template>
	<link rel="stylesheet" href="login.css">
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">

	<div class="splash" id="user-login">
		<img src="logo.svg" class="logo"><br>

		<div ng-if="loggedIn">
			<span class="greeting">{{greetingPrefix}}, {{username}}</span>
		</div>

		<div ng-if="serviceLoggedIn">
			<span class="greeting">{{greetingPrefix}}</span>
		</div>

		<div ng-if="!newUser && !forgotPassword && !newSignup && !loggedIn && !serviceLoggedIn">
			<div (keydown)="loginAttempt()" id="loginscreen">
				<div id="top">
					<div id="login">
						<div id="waiting-email" ng-if="waitingOnEmail">
							Please check your email.
						</div>
						<input type="email" class="{{waiting?'waiting':''}}" value="{{email}}" placeholder="Email">
						<input type="password" class="{{waiting?'waiting':''}}" value="{{password}}" placeholder="Password">

						<div ng-if="passwordConfirmation">
							<input id="confirm-password" class="{{waiting?'waiting':''}}" type="password" placeholder="Confirm Password">
						</div>


						<div id="warning"></div>
						<div id="loginsubmit">
							<button id="loginbutton" class="{{waiting?'waiting':''}} btn-big" (click)="loginAttempt()"><i class="fa fa-sign-in"></i> Log In</button>
							<button class="{{waiting?'waiting':''}} btn-big" (click)="verifyEmail()"><i class="fa fa-pencil"></i> Sign Up</button>
						</div>
					</div>
				</div>
				<div id="bottom">
					<div id="social">
						<button id="google" class="{{waiting?'waiting':''}} btn-light" provider="google" (click)="oauthLogin()"><i class="fa fa-google"></i> Google</button>
						<button id="facebook" class="{{waiting?'waiting':''}} btn-light" provider="facebook" (click)="oauthLogin()"><i class="fa fa-facebook"></i> Facebook</button>
						<button id="github" class="{{waiting?'waiting':''}} btn-light" provider="github" (click)="oauthLogin()"><i class="fa fa-github"></i> GitHub</button>
					</div>
				</div>
				<div id="forgot-password" (click)="togglePassword()">Forgot your password?</div>
			</div>
		</div>

		<div ng-if="timedout">
			<span class="greeting">
			Oh no!<br>
			Looks like the server is a bit slow.<br>
			Please check back another time. :(
			</span><br><br>
		</div>

		<div ng-if="newUser">
			<div (keydown)="usernameSubmit()" id="createuser">
				<div class="greeting">Hey, a new face!</div>
				<div>What do you want to be called?</div><br>
				<input id="username" type="text" placeholder="Username (You can change this later)" [value]="newUsername" [disabled]="existingUser ? '' : null">
				<button id="createuserbutton" class="btn-light btn-big {{waiting?'waiting':''}}" (click)="usernameSubmit()">That's totally me!</button>
				<div id="avatar-preview">
					<div id="avatar-left" (click)="updateAvatarPreview()" title="Click to Refresh">
						<div id="avatar-container">
							<div id="avatar-img" [style.background-image]="avatarUrl"></div>
						</div>
						<img src="youlabel.svg">
					</div>
					<div>
						<p class="small">If you had an account on Glitch, use the same username here to get your old avatar.</p>
						<p class="small">Because we do not yet have avatar customization, usernames that didn't exist in Glitch will revert to our default appearance.</p>
						<p class="blue">Click the preview to refresh it.</p>
					</div>
				</div>
			</div>
		</div>

		<div ng-if="forgotPassword">
			<div id="passwordReset">
				<div class="greeting">Password Reset</div>

				<div ng-if="!resetStageTwo">
					<div>Enter your email</div>
					<input type="text" placeholder="Email" value="{{email}}">
				</div>

				<div ng-if="resetStageTwo">
					<div>Get an email?</div>
					<input id="temp-password" type="password" placeholder="Temporary Password">
					<div>Enter your new Password</div>

					<input id="new-password-1" type="password" placeholder="New Password">
					<input id="new-password-2" type="password" placeholder="Confirm New Password">
					<div id="password-warning"></div>
				</div>

				<button id="resetButton" class="btn-warn" (click)="resetPassword">Submit</button>
			</div>
			<div id="back-to-main" (click)="togglePassword()">Go back?</div>
		</div>
	</div>
</template>