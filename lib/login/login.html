<!DOCTYPE html>
<link rel="import" href="../../../packages/polymer/polymer.html">
<link rel="import" href="../../../packages/cou_toolkit/toolkit/toolkit.html">

<polymer-element name="ur-login" attributes="serveraddress serverwebsocket">
	<template>
		<link rel="stylesheet" href="login.css">
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

		<ur-panel class="splash" id="user-login">
			<img src="logo.svg" class="logo"><br>

			<template if="{{loggedIn}}">
				<span class="greeting">It's good to see you, {{username}}</span>
			</template>

			<template if="{{!newUser && !newSignup && !loggedIn}}">
				<div on-keydown="{{loginAttempt}}" id="loginscreen">
					<div id="top">
						<div id="login">
							<input type="email" value="{{email}}" placeholder="Email">
							<input type="password" value="{{password}}" placeholder="Password">
							<div id="loginsubmit">
								<ur-button id="loginbutton" class="{{waiting?'waiting':''}}" on-click="{{loginAttempt}}"><i class="fa fa-sign-in"></i> Log In</ur-button>
								<ur-button class="{{waiting?'waiting':''}}" on-click="{{verifyEmail}}"><i class="fa fa-pencil"></i> Sign Up</ur-button>
							</div>
							<div id="msg">
								<template if="{{waitingOnEmail}}">
									Please check your email.<br>
								</template>
								<template if="{{invalidEmail}}">
									Please enter a valid email.
								</template>
								<template if="{{passwordTooShort}}">
										New passwords need to be
										<br>
										longer than 6 characters
								</template>
							</div>
						</div>
					</div>
					<div id="bottom">
						<div id="social">
							<ur-button theme="light" provider="google" on-click="{{oauthLogin}}"><i class="fa fa-google"></i> Google</ur-button>
							<ur-button id="facebook" theme="light" provider="facebook" on-click="{{oauthLogin}}"><i class="fa fa-facebook"></i> Facebook</ur-button>
							<ur-button theme="light" provider="github" on-click="{{oauthLogin}}"><i class="fa fa-github"></i> GitHub</ur-button>
						</div>
					</div>
				</div>
			</template>

			<template if="{{timedout}}">
				<div>
					<span class="greeting">
					Oh no!<br>
					Looks like the server is a bit slow.<br>
					Please check back another time. :(
					</span><br><br>
				</div>
			</template>

			<template if="{{newUser}}">
				<div on-keydown="{{usernameSubmit}}" id="createuser">
					<div class="greeting">Hey, a new face!</div>
					<div>What do you want to be called?</div><br>
					<input type="text" placeholder="Username (You can change this later)" value="{{newUsername}}" disabled?="{{existingUser}}">
					<input type="text" placeholder="Email" value="{{email}}" disabled>
					<input type="password" placeholder="Create Password" value="{{newPassword}}">
					<ur-button id="createuserbutton" big="true" theme="success" on-click="{{usernameSubmit}}">Submit</ur-button>
				</div>
			</template>

		</ur-panel>
	</template>
	<script type="application/dart" src="login.dart"></script>
</polymer-element>